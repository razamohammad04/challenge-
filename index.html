<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fashion Hub - Modern Style</title>
<style>
  /* ... All your previous CSS ... */
  #face-detect-collection-feature {
    max-width: 440px;
    margin: 50px auto 80px auto;
    background: #fff5f6;
    border-radius: 18px;
    padding: 34px 24px 28px 24px;
    box-shadow: 0 10px 32px rgba(218, 74, 86, 0.13);
    text-align: center;
    border: 1.5px solid #d44752;
  }
  #face-detect-collection-feature h3 {
    margin-bottom: 16px;
    font-size: 1.28rem;
    font-weight: 900;
    letter-spacing: 2px;
  }
  #facePhotoInputCollection {
    margin-bottom: 10px;
  }
  #suggestedDressCollection {
    margin-top: 24px;
    font-size: 1.18rem;
    color: #a82b33;
    font-weight: 700;
  }
</style>
</head>
<body>
<header>
  <div class="header-title">Fashion Hub</div>
</header>
<nav>
  <ul>
    <li><a href="#home" class="active" onclick="showSection('home')">Home</a></li>
    <li><a href="#collection" onclick="showSection('collection')">Collection</a></li>
    <li><a href="#contact" onclick="showSection('contact')">Contact</a></li>
    <li><a href="#about" onclick="showSection('about')">About Us</a></li>
  </ul>
</nav>
<div class="order-now-btn" onclick="alert('Order Now process started!')">Order Now</div>
<section id="home" class="container">
  <!-- ... keep your previous Home Section ... -->
</section>
<section id="collection" class="new-arrivals" style="display:none;">
  <h2>New Arrivals</h2>

  <!-- Face detection feature in Collection section -->
  <div id="face-detect-collection-feature">
    <h3>Find the Perfect Dress for Your Face Shape</h3>
    <input type="file" id="facePhotoInputCollection" accept="image/*" />
    <img id="facePhotoPreviewCollection" style="width:200px; display:none; margin-top:18px; border-radius:14px;" />
    <button id="detectFaceBtnCollection" class="shop-btn" style="margin-top:16px;">Detect Face & Suggest Dress</button>
    <div id="suggestedDressCollection"></div>
  </div>

  <div class="products">
    <!-- ... keep your previous collection products ... -->
  </div>
</section>
<section id="contact" class="container" style="display:none; max-width: 620px; margin: 50px auto;">
  <!-- ... Contact section as before ... -->
</section>
<section id="about" class="container" style="display:none; max-width: 740px; margin: 60px auto; text-align: center; color: #7a121d;">
  <!-- ... About section as before ... -->
</section>
<footer>
  &copy; 2025 Fashion Hub. All rights reserved.
</footer>
<script>
  function showSection(sectionId) {
    const sections = ['home', 'collection', 'contact', 'about'];
    sections.forEach(id => {
      document.getElementById(id).style.display = id === sectionId ? 'block' : 'none';
    });
    // Update active nav link
    const navLinks = document.querySelectorAll('nav ul li a');
    navLinks.forEach(link => {
      link.classList.toggle('active', link.getAttribute('href') === '#' + sectionId);
    });
  }
  function submitContact(event) {
    event.preventDefault();
    alert('Thank you for reaching out! We will get back to you soon.');
    event.target.reset();
  }
  // Show home section by default on page load
  showSection('home');

  // Face Detection Feature for Collection Section
  document.getElementById('facePhotoInputCollection').addEventListener('change', function(e) {
    const file = e.target.files;
    if (file) {
      const reader = new FileReader();
      reader.onload = function(event) {
        const img = document.getElementById('facePhotoPreviewCollection');
        img.src = event.target.result;
        img.style.display = 'block';
      };
      reader.readAsDataURL(file);
    }
  });

  document.getElementById('detectFaceBtnCollection').addEventListener('click', async function() {
    const imgElem = document.getElementById('facePhotoPreviewCollection');
    if (!imgElem.src || imgElem.style.display === 'none') {
      document.getElementById('suggestedDressCollection').innerHTML =
        "Please upload a face photo first.";
      return;
    }
    document.getElementById('suggestedDressCollection').innerHTML = "Detecting face, please wait...";

    // Convert image to Base64 string
    function getBase64Image(img) {
      var canvas = document.createElement("canvas");
      canvas.width = img.naturalWidth || img.width;
      canvas.height = img.naturalHeight || img.height;
      var ctx = canvas.getContext("2d");
      ctx.drawImage(img, 0, 0);
      return canvas.toDataURL("image/jpeg").replace(/^data:image\/(png|jpeg);base64,/, "");
    }
    const base64Image = getBase64Image(imgElem);

    // Google Cloud Vision API call (face detection)
    try {
      const apiKey = "AIzaSyAEFsRkftFWN5s9FIvELok1cN89MbdUyRg";
      const response = await fetch(
        https://vision.googleapis.com/v1/images:annotate?key=${apiKey},
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            requests: [
              {
                image: { content: base64Image },
                features: [{ type: "FACE_DETECTION", maxResults: 1 }]
              }
            ]
          })
        }
      );
      const result = await response.json();

      // Parse API response
      const faceAnnotations = (
        result.responses &&
        result.responses &&
        result.responses.faceAnnotations &&
        result.responses.faceAnnotations
      );
      if (!faceAnnotations) {
        document.getElementById('suggestedDressCollection').innerHTML =
          "No face detected. Please try another photo.";
        return;
      }

      // Example logic for face shape using bounding polygon width/height ratio
      const boundingPoly = faceAnnotations.fdBoundingPoly.vertices;
      const width = Math.abs(boundingPoly[2].x - boundingPoly.x);
      const height = Math.abs(boundingPoly[2].y - boundingPoly.y);
      let faceShape = "";
      if (width / height > 1.05) faceShape = "Round";
      else if (height / width > 1.2) faceShape = "Long";
      else faceShape = "Oval";

      // Recommend dress based on detected face shape
      let recommendedDress = "";
      if (faceShape === "Oval") recommendedDress = "Elegant Evening Dress";
      else if (faceShape === "Round") recommendedDress = "Modern Maxi Dress";
      else if (faceShape === "Long") recommendedDress = "Classic Black Dress";
      else recommendedDress = "Casual Chic Outfit";

      document.getElementById('suggestedDressCollection').innerHTML =
        `<b>Detected Face Shape:</b> ${faceShape}<br>
         <b>Recommended Dress:</b> ${recommendedDress}`;
    } catch (error) {
      document.getElementById('suggestedDressCollection').innerHTML =
        "Error in face detection: " + error;
    }
  });
</script>
</body>
</html>
